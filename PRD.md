아래는 \*\*“구내식당 메뉴 크롤링 및 AI 인식 카카오톡 알림 서비스”\*\*에 대한 PRD(제품 요구사항 정의서, Product Requirements Document) 초안입니다. 서비스 구현에 필요한 추가 결정 사항도 함께 정리했어요.

---

### 📝 PRD: 구내식당 메뉴 크롤링 및 알림 서비스

---

#### 1. **개요**

* **목적**: 매주 업데이트되는 구내식당 주간 메뉴 이미지를 자동으로 크롤링하고, Google Gemini API를 통해 이미지에서 텍스트(메뉴)를 추출하여, 해당 요일의 메뉴를 당일 아침 카카오톡 메시지로 자동 발송.
* **개발 언어**: Python
* **AI 모델**: Google Gemini Vision API
* **알림 채널**: 카카오톡 (Self 채널 또는 친구톡 방식 고려)
* **운영 환경**: 로컬 서버 (추후 클라우드 이전 고려 가능)

---

#### 2. **핵심 기능**

| 기능     | 설명                                         |
| ------ | ------------------------------------------ |
| 웹 크롤링  | 지정된 URL에서 주간 메뉴 이미지를 주기적으로 다운로드            |
| 이미지 저장 | 메뉴 이미지를 주간 단위로 파일 시스템에 저장                  |
| 이미지 인식 | Google Gemini API를 통해 OCR 수행, 요일별 메뉴 추출    |
| 메뉴 파싱  | YOLO 형태 혹은 좌표 기반 이미지 내 텍스트 위치 분석 필요시 보완    |
| 메뉴 알림  | 해당 요일의 메뉴를 매일 아침 9시 전후로 카카오톡으로 발송          |
| 에러 로깅  | 크롤링 실패, API 응답 오류, 메시지 실패 등에 대한 로깅 및 알림 기능 |

---

#### 3. **시스템 구성도 (로컬 기반)**

```
[Scheduler (cron)] ─▶ [Python App]
     │                      │
     ▼                      ▼
[웹 페이지 크롤링]   [이전 메뉴 이미지 저장 여부 확인]
     ▼                      ▼
[메뉴 이미지 저장]   [Gemini API 호출]
                             ▼
                    [요일별 텍스트 메뉴 추출]
                             ▼
                      [카카오톡 메시지 전송]
```

---

#### 4. **기술 스택**

| 구성 요소   | 기술                                                   |
| ------- | ---------------------------------------------------- |
| 크롤러     | `requests`, `BeautifulSoup`, `Selenium` (동적 페이지일 경우) |
| 이미지 저장  | `os`, `datetime`, `Pillow`                           |
| 이미지 인식  | Google Gemini Vision API (base64 인코딩 방식 권장)          |
| 카카오톡 연동 | REST API (Self 메세지 전송용 템플릿 or 친구톡 사용)                |
| 스케줄러    | `schedule`, `APScheduler` or 로컬 `cron`               |
| 로깅/모니터링 | `logging`, 알림은 슬랙이나 이메일 연동 가능                        |

---

#### 5. **로컬 서버 운영 방식**

* Python `Flask` 또는 `FastAPI`를 사용하여 REST 서버로 개발
* 서버 기동 시 주간 이미지 크롤링과 Gemini 호출, 알림 발송을 수행
* 일정 작업은 `schedule` 또는 `APScheduler`로 처리 (예: 매주 월요일 크롤링, 평일 9시 알림 발송)

---

#### 6. **추가 결정이 필요한 사항**

| 항목             | 질문                                             |
| -------------- | ---------------------------------------------- |
| 이미지 위치         | 메뉴 이미지가 위치한 정확한 URL 구조는 고정되어 있는가? 변경될 가능성 있는가? |
| 이미지 포맷         | 이미지 내에 요일별 구분이 명확한가? 테이블 형태인가?                 |
| Gemini API Key | 이미 발급받았는가? 월 사용량 제한을 확인했는가?                    |
| 카카오톡 채널        | Self 메시지 발송을 위한 비즈니스 채널 개설 및 검수가 되었는가?         |
| 예외 처리          | OCR 실패 시 대체 문구나 재시도 방식이 정해졌는가?                 |
| 데이터 보관         | 추출한 메뉴 기록은 저장할 것인가? (예: JSON 또는 DB)            |

---

### 📌 다음 단계 제안

1. 이미지 URL 구조 확인 및 크롤링 테스트 코드 작성
2. Google Gemini Vision API 테스트 (이미지 → 텍스트 정확도 확인)
3. 카카오톡 알림 방식 결정 및 토큰 설정
4. 전체 파이프라인을 로컬 Python 스크립트로 구성
5. 스케줄링 및 예외 상황 로깅 시스템 추가

---

필요하다면 각 항목별로 샘플 코드도 바로 제공할 수 있어요.
특히 **Gemini Vision API 연동 코드**, **카카오톡 메시지 발송 예제**, **크롤링 스크립트**, **스케줄링 구성**부터 시작하는 것이 좋습니다.

어떤 부분부터 구현을 도와드릴까요?
